---
databaseChangeLog:
  - changeSet:
      id: STORMKNIGHTS-init
      author: rlichti
      context: init
      labels: 'v1.0.0,stormknights'
      dbms: postgresql
      created: '1.0.0'
      changes:
        - createTable:
            tableName: STORMKNIGHTS
            remarks: The player connected to the torganized play
            columns:
              - column:
                  name: ID
                  type: BIGINT
                  autoIncrement: true
                  startWith: 10000
                  remarks: The Database internal ID
                constraints:
                  - primaryKey: true
                  - primaryKeyName: STORMKNIGHTS_PK
                  - nullable: false
                  - notNullConstraintName: STORMKNIGHTS_ID_NN
                  - unique: true
                  - uniqueConstraintName: STORMKNIGHTS_ID_UK
              - column:
                  name: UID
                  type: UUID
                  valueComputed: uuid_generate_v4()
                constraints:
                  - nullable: false
                  - notNullConstraintName: STORMKNIGHTS_UID_NN
                  - unique: true
                  - uniqueConstraintName: STORMKNIGHTS_UID_UK
              - column:
                  name: CREATED
                  type: TIMESTAMP WITH TIME ZONE
                  valueComputed: now()
                constraints:
                  - nullable: false
                  - notNullConstraintName: STORMKNIGHTS_CREATED_NN
              - column:
                  name: MODIFIED
                  type: TIMESTAMP WITH TIME ZONE
                  valueComputed: now()
                constraints:
                  - nullable: false
                  - notNullConstraintName: STORMKNIGHTS_MODIFIED_NN
              - column:
                  name: DELETED
                  type: TIMESTAMP WITH TIME ZONE
              - column:
                  name: NAMESPACE
                  type: VARCHAR(100)
                  defaultValue: './.'
                constraints:
                  - nullable: false
                  - notNullConstraintName: STORMKNIGHTS_NAMESPACE_NN
              - column:
                  name: NAME
                  type: VARCHAR(100)
                constraints:
                  - nullable: false
                  - notNullConstraintName: STORMKNIGHTS_NAME_NN
              - column:
                  name: COSM
                  type: VARCHAR(100)
                  defaultValue: CORE_EARTH
                constraints:
                  - nullable: false
                  - notNullConstraintName: STORMKNIGHTS_COSM_NN
              - column:
                  name: XP
                  type: BIGINT
                  defaultNumericValue: 0
                constraints:
                  - nullable: false
                  - notNullConstraintName: STORMKNIGHTS_XP_NN
        - createTable:
            tableName: SKHISTORY
            remarks: The history of a storm knight
            columns:
              - column:
                  name: ID
                  type: BIGINT
                  autoIncrement: true
                  startWith: 10000
                  remarks: The Database internal ID
                constraints:
                  - primaryKey: true
                  - primaryKeyName: SKHISTORY_PK
                  - nullable: false
                  - notNullConstraintName: SKHISTORY_ID_NN
                  - unique: true
                  - uniqueConstraintName: SKHISTORY_ID_UK
              - column:
                  name: CREATED
                  type: TIMESTAMP WITH TIME ZONE
                  valueComputed: now()
                constraints:
                  - nullable: false
                  - notNullConstraintName: SKHISTORY_CREATED_NN
              - column:
                  name: MODIFIED
                  type: TIMESTAMP WITH TIME ZONE
                  valueComputed: now()
                constraints:
                  - nullable: false
                  - notNullConstraintName: SKHISTORY_MODIFIED_NN
              - column:
                  name: DELETED
                  type: TIMESTAMP WITH TIME ZONE
              - column:
                  name: STORMKNIGHT
                  type: BIGINT
                  remarks: The Storm Knight for this entry
                constraints:
                  - nullable: false
                  - notNullConstraintName: SKHISTORY_STORMKNIGHT_NN
                  - foreignKeyName: SKHISTORY_STORMKNIGHT_FK
                  - referencedTableName: STORMKNIGHTS
                  - referencedColumnName: ID
              - column:
                  name: MISSION_NAME
                  type: VARCHAR(100)
                constraints:
                  - nullable: false
                  - notNullConstraintName: SKHISTORY_MISSION_NAME_NN
              - column:
                  name: MISSION_DATE
                  type: TIMESTAMP WITH TIME ZONE
                constraints:
                  - nullable: false
                  - notNullConstraintName: SKHISTORY_MISSION_DATE_NN
              - column:
                  name: MISSION_UID
                  type: UUID
                constraints:
                  - nullable: false 
                  - notNullConstraintName: SKHISTORY_MISSION_UID_NN
              - column:
                  name: XP
                  type: BIGINT
                  defaultNumericValue: 5
                constraints:
                  - nullable: false
                  - notNullConstraintName: SKHISTORY_XP_NN
              - column:
                  name: PAYMENT
                  type: BIGINT
                  defaultNumericValue: 200
                constraints:
                  - nullable: false
                  - notNullConstraintName: SKHISTORY_PAYMENT_NN
              - column:
                  name: REPORT
                  type: VARCHAR(5000)
              - column:
                  name: SUCCESS
                  type: VARCHAR(100)
                constraints:
                  - nullable: false
                  - notNullConstraintName: SKHISTORY_SUCCESS_NN
        - addUniqueConstraint:
            constraintName: STORMKNIGHTS_NAME_UK
            tableName: STORMKNIGHTS
            columnNames: 'NAMESPACE,NAME'
        