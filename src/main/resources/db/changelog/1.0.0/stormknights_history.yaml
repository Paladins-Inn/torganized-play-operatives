---
databaseChangeLog:
  - changeSet:
      id: 20240907-rlichti-001
      author: rlichti
      context: init
      labels: 'v1.0.0,stormknights'
      dbms: postgresql
      created: '1.0.0'
      changes:
        - dropTable:
            tableName: SKHISTORY
            cascadeConstraints: true
        - createTable:
            tableName: STORMKNIGHTS_HISTORY
            remarks: The history of a storm knight
            columns:
              - column:
                  name: STORMKNIGHT
                  type: BIGINT
                  remarks: The Storm Knight for this entry
                constraints:
                  - nullable: false
                  - notNullConstraintName: STORMKNIGHTS_HISTORY_STORMKNIGHT_NN
                  - foreignKeyName: STORMKNIGHTS_HISTORY_STORMKNIGHT_FK
                  - referencedTableName: STORMKNIGHTS
                  - referencedColumnName: ID
              - column:
                  name: CREATED
                  type: TIMESTAMP WITH TIME ZONE
                  valueComputed: now()
                constraints:
                  - nullable: false
                  - notNullConstraintName: STORMKNIGHTS_HISTORY_CREATED_NN
              - column:
                  name: MODIFIED
                  type: TIMESTAMP WITH TIME ZONE
                  valueComputed: now()
                constraints:
                  - nullable: false
                  - notNullConstraintName: STORMKNIGHTS_HISTORY_MODIFIED_NN
              - column:
                  name: DELETED
                  type: TIMESTAMP WITH TIME ZONE
              - column:
                  name: MISSION_NAME
                  type: VARCHAR(100)
                constraints:
                  - nullable: false
                  - notNullConstraintName: STORMKNIGHTS_HISTORY_MISSION_NAME_NN
              - column:
                  name: MISSION_DATE
                  type: TIMESTAMP WITH TIME ZONE
                constraints:
                  - nullable: false
                  - notNullConstraintName: STORMKNIGHTS_HISTORY_MISSION_DATE_NN
              - column:
                  name: MISSION_UID
                  type: UUID
                constraints:
                  - nullable: false 
                  - notNullConstraintName: STORMKNIGHTS_HISTORY_MISSION_UID_NN
              - column:
                  name: XP
                  type: BIGINT
                  defaultValueNumeric: 5
                constraints:
                  - nullable: false
                  - notNullConstraintName: STORMKNIGHTS_HISTORY_XP_NN
              - column:
                  name: PAYMENT
                  type: BIGINT
                  defaultValueNumeric: 200
                constraints:
                  - nullable: false
                  - notNullConstraintName: STORMKNIGHTS_HISTORY_PAYMENT_NN
              - column:
                  name: REPORT
                  type: VARCHAR(5000)
              - column:
                  name: SUCCESS
                  type: VARCHAR(100)
                constraints:
                  - nullable: false
                  - notNullConstraintName: STORMKNIGHTS_HISTORY_SUCCESS_NN
        - addUniqueConstraint:
            constraintName: STORMKNIGHTS_HISTORY_STORMKNIGHT_MISSION_UK
            tableName: STORMKNIGHTS_HISTORY
            columnNames: 'STORMKNIGHT,MISSION_UID'
